<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="https://unpkg.com/autonumeric@4.6.0/dist/autoNumeric.min.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>DOCS zummon webapp</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.0/css/bulma.min.css">
    <link rel="stylesheet" href="../style/core.css">
    <link rel="stylesheet" href="../style/docs.css">
    <link rel="stylesheet" href="../style/bulma.css">
    <style>
        body {
            min-width: 640px;
        }
        #vendor_name,
        #client_name,
        #ref,
        #date,
        #duedate,
        #client_sign,
        [name=item] {
            border: none;
            background-color: transparent;
        }
        #vendor_name,
        #client_name,
        #client_sign,
        [name=item] {
            width: 100%;
        }
        #line_label,
        #price_label,
        #qty_label,
        #amount_label {
            width: 1px;
        }
        #client_sign {
            resize: vertical;
        }
        .table tfoot th {
            border-top-width: 1px;
        }
    </style>
</head>
<body>
    <div id="action" class="container">
        <div class="tabs is-fullwidth is-medium has-background-white has-text-weight-semibold">
            <ul>
                <li><a id="action_clear">Clear*</a></li>
                <li><a id="action_pop">Pop</a></li>
                <li><a id="action_config">Config</a></li>
                <li><a id="action_add">Add</a></li>
                <li><a id="action_print">Print</a></li>
            </ul>
        </div>
    </div>
    <div id="config" class="container has-background-light section">
        <div class="columns is-mobile is-multiline">
            <div class="column is-4">
                <label for="config_saletax_rate" class="label">sales tax</label>
                <input id="config_saletax_rate" class="input" type="number" step="0.01">
            </div>
            <div class="column is-4">
                <label for="config_incometax_rate" class="label">income tax</label>
                <input id="config_incometax_rate" class="input" type="number" step="0.01">
            </div>
            <div class="column is-4">
                <label for="config_lang" class="label">language</label>
                <div class="select">
                    <select id="config_lang"></select>
                </div>
            </div>
            <div class="column is-4">
                <label for="config_doc_title" class="label">title*</label>
                <div class="select">
                    <select id="config_doc_title"></select>
                </div>
            </div>
            <div class="column is-4">
                <label for="config_an_price" class="label">price</label>
                <div class="select">
                    <select id="config_an_price"></select>
                </div>
            </div>
            <div class="column is-4">
                <label for="config_an_qty" class="label">qty</label>
                <div class="select">
                    <select id="config_an_qty"></select>
                </div>
            </div>
            <div class="column is-4">
                <label for="config_date_type" class="label">date type</label>
                <div class="select">
                    <select id="config_date_type"></select>
                </div>
            </div>
            <div class="column is-4">
                <label for="config_color" class="label">color</label>
                <div class="select">
                    <select id="config_color"></select>
                </div>
            </div>
            <div class="column is-4">
                <label for="config_headlogo" class="label">Logo</label>
                <div class="file is-white">
                    <label class="file-label">
                        <input id="config_headlogo" class="file-input" type="file">
                        <span class="file-cta">
                            <span class="file-label">Upload</span>
                        </span>
                    </label>
                </div>
            </div>
        </div>
        <div class="columns is-mobile is-multiline">
            <div class="column is-4">
                <input id="config_headlogo_img" type="checkbox" checked>
                <label for="config_headlogo_img" class="checkbox">head logo</label>
            </div>
            <div class="column is-4">
                <input id="config_duedate" type="checkbox" checked>
                <label for="config_duedate" class="checkbox">due date</label>
            </div>
            <div class="column is-4">
                <input id="config_vendor_id" type="checkbox" checked>
                <label for="config_vendor_id" class="checkbox">vendor register</label>
            </div>
            <div class="column is-4">
                <input id="config_client_id" type="checkbox" checked>
                <label for="config_client_id" class="checkbox">client register</label>
            </div>
            <div class="column is-4">
                <input id="config_payment" type="checkbox" checked>
                <label for="config_payment" class="checkbox">payment</label>
            </div>
            <div class="column is-4">
                <input id="config_subject" type="checkbox" checked>
                <label for="config_subject" class="checkbox">project</label>
            </div>
            <div class="column is-4">
                <input id="config_note" type="checkbox" checked>
                <label for="config_note" class="checkbox">note</label>
            </div>
            <div class="column is-4">
                <input id="config_client_sign" type="checkbox" checked>
                <label for="config_client_sign" class="checkbox">client sign</label>
            </div>
            <div class="column is-4">
                <input id="config_saletax" type="checkbox" checked>
                <label for="config_saletax" class="checkbox">sale tax</label>
            </div>
            <div class="column is-4">
                <input id="config_incometax" type="checkbox" checked>
                <label for="config_incometax" class="checkbox">income tax</label>
            </div>
        </div>
    </div>

<!--------------------------------------------------------------------------------------------------------------------->

    <div id="doc" class="container has-background-white">
        <div class="columns is-mobile">
            <div class="column">
                <img id="headlogo_img" src="">
                <input id="vendor_name" type="text" class="subtitle has-text-weight-bold" value="Your company">
                <p id="vendor_id">Register</p>
                <p id="vendor_address">Address</p>
            </div>
            <div class="column">
                <div class="has-background-info has-text-white has-text-right">
                    <h1 id="doc_title" class="title is-1">Invoice</h1>
                    <p><span id="ref_label">inv-no</span><input id="ref" type="text"></p>
                    <p><span id="date_label">inv-date</span><input id="date" type="date"></p>
                    <p><span id="duedate_label">inv-date</span><input id="duedate" type="date"></p>
                </div>
            </div>
        </div>
        <div class="columns is-mobile">
            <div class="column">
                <div class="field">
                    <span id="payment_label">payment</span>
                    <p id="payment" class="has-text-weight-bold">Tell client how to pay</p>
                </div>
                <div class="field">
                    <span id="subject_label">subject</span>
                    <p id="subject" class="has-text-weight-bold">Fill the project name</p>
                </div>
            </div>
            <div class="column">
                <span id="client_name_label" class="is-white has-text-weight-semibold">Bill to</span>
                <input id="client_name" type="text" class="subtitle has-text-weight-bold" value="Client company">
                <p id="client_id" >Register</p>
                <p id="client_address" >Address</p>
            </div>
        </div>

        <table class="table is-fullwidth is-hoverable">
            <thead>
                <tr>
                    <th id="line_label" class="is-info">line</th>
                    <th id="item_label" class="is-info">item</th>
                    <th id="price_label" class="is-info">price</th>
                    <th id="qty_label" class="is-info">qty</th>
                    <th id="amount_label" class="is-info">amount</th>
                </tr>
            </thead>
            <tbody id="tbody">
                <tr name="tr">
                    <td name="line"></td>
                    <td><input name="item" type="text"></td>
                    <td name="price" class="has-text-centered"></td>
                    <td name="qty" class="has-text-centered"></td>
                    <td name="amount" class="has-text-right"></td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <th colspan="2" rowspan="5">
                        <span id="note_label">note</span>
                        <p id="note" class="has-text-weight-normal">Tell client more information</p>
                    </th>
                    <th id="total_label" colspan="2" class="">subtotal</th>
                    <th id="total" class="has-text-right"></th>
                </tr>
                <tr>
                    <th colspan="2" class="">
                        <span id="saletax_label">saletax</span>
                        <span id="saletax_rate" class="tag is-info">7%</span>
                    </th>
                    <th id="saletax" class=" has-text-right"></th>
                </tr>
                <tr>
                    <th colspan="2" class="">
                        <span id="incometax_label">incometax</span>
                        <span id="incometax_rate" class="tag is-info">3%</span>
                    </th>
                    <th id="incometax" class=" has-text-right"></th>
                </tr>
                <tr>
                    <th id="adjust_label" colspan="2" class="">adjust</th>
                    <th id="adjust" class=" has-text-right"></th>
                </tr>
                <tr>
                    <th id="finaltotal_label" colspan="2" class="is-info">Total</th>
                    <th id="finaltotal" class="is-info has-text-right"></th>
                </tr>
            </tfoot>
        </table>

        <div class="columns is-mobile">
            <div class="column">
                <h4 id="thank_message" class="title is-4 has-text-centered">Thank you</h4>
            </div>
            <div class="column">
                <span id="client_sign_label">client_sign</span>
                <textarea id="client_sign" rows="2" class=""></textarea>
                <p id="client_rank" class=""></p>
            </div>
        </div>

    </div>
    
<!--------------------------------------------------------------------------------------------------------------------->
    
    <datalist id="client_list"></datalist>
    <datalist id="item_list"></datalist>
    
    <div id="footer">
        <div>
            <h2 id="footer_library">Library usage</h2>
            <ul>
                <li><a id="footer_autonumeric"></a></li>
                <li><a id="footer_bulma"></a></li>
            </ul>
        </div>
        <div>
            <h2 id="footer_madeby">Made by</h2>
            <ul>
                <li><a id="footer_github">zummon (Github)</a></li>
                <li><a id="footer_facebook">zummon (Facebook: zummontt)</a></li>
                <li><a id="footer_paypal">donate to support (PayPal: zummontt)</a></li>
            </ul>
        </div>
    </div>

    <script src="../source/core.js"></script>
    <script src="../source/browse_docs.js"></script>
    <script src="../source/brief_docs.js"></script>
    <script src="../source/docs.js"></script>
    <script src="../source/docs_inv.js"></script>
    <script>
        
        tr_show = 4
        tr_hide = 16
        content_editable = `
            #vendor_name
            ,#vendor_id
            ,#vendor_address
            ,#doc_title
            ,#ref
            ,#ref_label
            ,#date
            ,#date_label
            ,#duedate
            ,#duedate_label
            ,#client_name_label
            ,#client_name
            ,#client_id
            ,#client_address
            ,#payment_label
            ,#payment
            ,#subject_label
            ,#subject
            ,#line_label
            ,#item_label
            ,#price_label
            ,#qty_label
            ,#amount_label
            ,[name="line"]
            ,[name="item"]
            ,[name="price"]
            ,[name="qty"]
            ,[name="amount"]
            ,#note_label
            ,#note
            ,#client_sign_label
            ,#client_sign
            ,#client_rank
            ,#total_label
            ,#total
            ,#saletax_label
            ,#saletax_rate
            ,#saletax
            ,#incometax_label
            ,#incometax_rate
            ,#incometax
            ,#adjust_label
            ,#adjust
            ,#thank_message
            ,#finaltotal_label
            ,#finaltotal
        `
        // #headlogo_img
        // #tbody
        // [name="tr"]

        document.addEventListener('DOMContentLoaded',function(){

            // ---- autoNumeric ----
            
            var option = ans_price.filter(function(t){ return t[0] == userData.an_price })
                option = option == '' ? ans_price[0][1] : option[0][1]

an_price_obj = new AutoNumeric.multiple('[name="price"],[name="amount"],#total,#saletax,#incometax,#adjust,#finaltotal', option)

            var option = ans_qty.filter(function(t){ return t[0] == userData.an_qty })
                option = option == '' ? ans_qty[0][1] : option[0][1]

an_qty_obj = new AutoNumeric.multiple('[name="qty"]', option)

            // ---- config ----

            const config_color = document.querySelector('#config_color')
            ;[
                ['is-primary','turquoise'],
                ['is-link','blue'],
                ['is-info','cyan'],
                ['is-success','green'],
                ['is-warning','yellow'],
                ['is-danger','red'],
                ['is-dark','grey-darker'],
                ['is-black','black'],
            ].forEach(function(t){
                var op = document.createElement('option')
                op.value = t[0]
                op.textContent = t[1]
                config_color.appendChild(op)
            })

            config_color.addEventListener('change',function(e){
                const older = document.querySelector('#amount_label').className
                const newer = e.target.value
                document.querySelectorAll('[class*="' + older + '"]').forEach(function(t){
                    t.classList.remove(older)
                    t.classList.add(newer)
                })
            })

            document.querySelector('#config_headlogo').addEventListener('change',function(e){
                const applyto = e.target.id
                configUploadImage('#' + applyto.slice(7) + '_img', '#' + applyto)
            })

            document.querySelectorAll('#config_headlogo_img, #config_vendor_id, #config_client_id').forEach(function(t){
                t.addEventListener('change',function(e){
                    const elem = document.querySelector('#' + e.target.id.slice(7))
                    if (e.target.checked) {
                        elem.setAttribute('style', '')
                    } else {
                        elem.setAttribute('style', 'display: none;')
                    }
                })
            })
document.querySelectorAll('#config_duedate, #config_payment, #config_subject, #config_note, #config_client_sign, #config_saletax, #config_incometax').forEach(function(t){
    t.addEventListener('change',function(e){
        const applyto = e.target.id.slice(7)
        const elem = document.querySelector('#' + applyto).parentElement
        if (e.target.checked) {
            elem.setAttribute('style', '')
            if (['saletax','incometax'].indexOf(applyto) >= 0) {
                calculateTotal()
            }
        } else {
            elem.setAttribute('style', 'display: none;')
            if (['saletax','incometax'].indexOf(applyto) >= 0) {
                userData[applyto + '_rate'] = 0
                calculateTotal()
            }
        }
    })
})

            // untitled
            // invoice
            // quotation
            // receipt
            // taxinvoice


        })
        
        
    </script>
</body>
</html>